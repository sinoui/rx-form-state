---
name: è¡¨å•åˆå§‹å€¼ä¸é‡ç½®
route: /form-initial-values-and-reset
menu: æ•™ç¨‹
---

import { Playground } from 'docz';
import { useFormState, FormStateContext, Field } from '../src';

# è¡¨å•åˆå§‹å€¼ä¸é‡ç½®

## è®¾ç½®è¡¨å•åˆå§‹å€¼

[`useFormState(initialValues, options)`](api-use-form-state)çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¡¨å•åˆå§‹å€¼ï¼Œå®ƒçš„åŸºæœ¬ç”¨æ³•æ˜¯ï¼š

```ts
import { useFormState } from '@sinoui/rx-form-state';

function FormDemo() {
  const initialValues = {
    userName: 'å¼ ä¸‰',
    favs: ['ç¯®çƒ', 'è¶³çƒ'],
  };
  const formState = useFormState(initialValues);
}
```

æœ‰æ—¶åº”ç”¨éœ€è¦å»æœåŠ¡å™¨ç«¯åŠ è½½è¡¨å•æ•°æ®ï¼Œä¾‹å¦‚ï¼š

```tsx
import useRestItemApi from '@sinoui/use-rest-item-api';
import { useFormState } from '@sinoui/rx-form-state';

function FormDemo() {
  const restState = useRestItemApi('/users', '1');
  const formState = useFormState(restState.data);
}
```

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`useFormState`ä¼šç›‘å¬`initialValues`å‚æ•°çš„å˜åŒ–ï¼Œä½¿ç”¨æ·±æ¯”è¾ƒçš„æ–¹å¼åˆ¤æ–­æœ‰å˜åŒ–åï¼Œä¼šé‡æ–°åº”ç”¨è¡¨å•åˆå§‹å€¼ï¼Œæ‰€ä»¥ï¼Œä¸‹é¢çš„ä»£ç å¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼š

```ts
import { useFormState } from '@sinoui/rx-form-state';

function FormDemo() {
  const initialValues = {
    day: new Date(), // ğŸ˜”ğŸ”´ æ¯æ¬¡FormDemoé‡ç»˜æ—¶ï¼Œdayæ€»æ˜¯ä¸€ä¸ªæ–°çš„å€¼ã€‚
  };
  const formState = useFormState(initialValues); // ğŸ˜”ğŸ”´ åœ¨FormDemoé‡ç»˜æ—¶ï¼Œä¼šå‡ºç°è¡¨å•å€¼ä¸¢å¤±æƒ…å†µ
}
```

æ¯æ¬¡`FormDemo`é‡ç»˜æ—¶ï¼Œ`initialValues.day`éƒ½æ˜¯ä¸€ä¸ªæ–°çš„å€¼ï¼Œè¿™æ ·`formState`æ€»æ˜¯ä¼šåº”ç”¨æ–°çš„`initialValues`ï¼Œå°†è¡¨å•å€¼è®¾ç½®ä¸º`initialValues`ã€‚å¯èƒ½æˆ‘ä»¬å·²ç»åœ¨è¡¨å•ä¸­å¡«å†™äº†ä¸€äº›æ•°æ®ï¼Œä½†æ˜¯ç”±äº`FormDemo`å‘ç”Ÿé‡ç»˜ï¼Œä¼šå¯¼è‡´å·²å¡«å†™çš„æ•°æ®ä¸¢å¤±ã€‚

è¿™ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥ä¸ç›‘å¬`initialValues`çš„å˜åŒ–ï¼š

```ts
import { useFormState } from '@sinoui/rx-form-state';

function FormDemo() {
  const initialValues = {
    day: new Date(),
  };
  const formState = useFormState(initialValues, {
    enableReinitialize: false, // âœ… ä¸ç›‘å¬initialValuesçš„å˜åŒ–
  });
}
```

æˆ–è€…ç¼“å­˜`initialValues`ï¼š

```ts
import { useMemo } from 'react';
import { useFormState } from '@sinoui/rx-form-state';

function FormDemo() {
  // âœ… ç¼“å­˜initialValues
  const initialValues = useMemo(
    () => ({
      day: new Date(),
    }),
    [],
  );

  const formState = useFormState(initialValues);
}
```

ä¸`@sinoui/use-rest-item-api`ç»“åˆä½¿ç”¨æ—¶ï¼Œå¯ä»¥è¿™æ ·å¤„ç†ï¼š

```tsx
import useRestItemApi from '@sinoui/use-rest-item-api';
import { useFormState } from '@sinoui/rx-form-state';

function FormDemo() {
  const userId = '1';
  const initialValues = {
    day: new Date(),
  };
  const restState = useRestItemApi('/users', userId, initialValues); // âœ… useRestItemApiä¸ä¼šç›‘å¬initialValuesçš„å˜åŒ–
  const formState = useFormState(restState.data);
}
```

## è¡¨å•é‡ç½®

è°ƒç”¨`formState.reset`æ–¹æ³•é‡ç½®è¡¨å•ã€‚ä¾‹å¦‚ï¼š

```tsx
import React from 'react';
import { useFormState, FormStateContext, Field } from '@sinoui/rx-form-state';

function FormDemo() {
  const initialValues = { userName: 'å¼ ä¸‰', note: 'è¿™æ˜¯åˆå§‹åŒ–æ•°æ®' };
  const formState = useFormState(initialValues);

  return (
    <FormStateContext.Provider value={formState}>
      <form>
        <label>ç”¨æˆ·å</label>
        <Field as="input" name="userName" />

        <label>å¯†ç </label>
        <Field as="input" name="password" type="password" />

        <label>å¹´é¾„</label>
        <Field as="input" name="age" type="number" />

        <label>å¤‡æ³¨</label>
        <Field as="input" name="note" />
      </form>
      <button onClick={() => formState.reset()}>é‡ç½®</button>
    </FormStateContext.Provider>
  );
}
```

è¿è¡Œæ•ˆæœï¼š

<Playground>
  {() => {
    const initialValues = { userName: 'å¼ ä¸‰', note: 'è¿™æ˜¯åˆå§‹åŒ–æ•°æ®' };
    const formState = useFormState(initialValues);
    return (
      <FormStateContext.Provider value={formState}>
        <>
          <form>
            <label>ç”¨æˆ·å</label>
            <Field as="input" name="userName" />
            <label>å¯†ç </label>
            <Field as="input" name="password" type="password" />
            <label>å¹´é¾„</label>
            <Field as="input" name="age" type="number" />
            <label>å¤‡æ³¨</label>
            <Field as="input" name="note" />
          </form>
        </>
        <button onClick={() => formState.reset()}>é‡ç½®</button>
      </FormStateContext.Provider>
    );
  }}
</Playground>
